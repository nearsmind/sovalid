"use strict";!function(e){function r(e,r){for(var n=e.length;n--;)if(e[n]===r)return n;return-1}var n=function(){function e(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function r(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function t(e){if(void 0===e)return!1;var r=+e;return isNaN(r)?!!String(e).toLowerCase().replace(!1,""):!!r}function a(e){return"string"==typeof e}function i(e){return"function"==typeof e}function u(e,r,t){if(!r||!n.isString(r)||!r.trim().length>0)return void 0;var a=r.split("."),i=e;if(a&&a.length>1)for(var u in a)i=i[a[u]];else i=e[a[0]];return!i&&t?t:i}return{isObject:e,isPlainObject:r,getBool:t,isString:a,isFunction:i,get:u}}(),t=function(){function u(){console.log(":::RULES:::"),console.log(e),console.log(":::FUNCTIONS:::"),console.log(r),console.log(":::VALIDATION PARTS:::"),console.log(t)}function l(r){return r&&!Array.isArray(r)&&r.name&&(e[r.name]=r),i}function s(e){return e&&Array.isArray(e)&&e.forEach(function(e){l(e)}),i}function o(r){return delete e[r],i}function f(e,n){return e&&n&&(r[e]=n),i}function d(e,r){return e&&r&&(t[e]={props:r}),i}function c(e){return t[e]?!0:!1}function v(e,t,i,u){function d(e){var r=typeof e;return"boolean"!==r||null!==e&&void 0!==e?!("number"!==r&&"boolean"!==r&&(!e||n.isString(e)&&""===e.trim())):!1}function c(r){var t=n.get(e,r.prop);if("number"==typeof r.value&&(""===t||void 0===t||null===t))return!1;switch("boolean"==typeof r.value&&(t=n.getBool(t)),r.operand){case a.greaterThan:return t>r.value;case a.greaterThanOrEqual:return t>=r.value;case a.lowerThan:return t<r.value;case a.lowerThanOrEqual:return t<=r.value;case a.equal:return t==r.value;case a.strictlyEqual:return t===r.value;case a.different:return t!=r.value;case a.strictlyDifferent:default:return t!==r.value}}function v(){if(t.global||void 0!==i&&null!==i)for(var e in t.validationRules)if(t.validationRules.hasOwnProperty(e)&&p(u,t.validationRules[e].steps)){var a=r[t.validationRules[e].fn];if(l=n.isFunction(t.validationRules[e].params.value)?a.call(this,i,t.validationRules[e].params.value.call(this)):a.call(this,i,t.validationRules[e].params),n.isObject(l)){if(!l.result)return s=l.error?l.error:e,o=t.validationRules[e].params,void(l=l.result);l=!0}else if(!l)return s=e,void(o=t.validationRules[e].params)}}function p(e,r){if(!e||0===e.length)return!0;if(r&&r.length>0)for(var n in e)if(-1!==r.indexOf(e[n]))return!0;return!1}var l=!0,s=void 0,o=void 0,f=!1;return function(){var r,a,o=d(i);for(a=0;a<t.passiveDepends.length;a++)if(r=n.isFunction(t.passiveDepends[a].value),r&&t.passiveDepends[a].value.call(this,n.get(e,t.passiveDepends[a].prop))||!r&&c(t.passiveDepends[a]))f=!0;else if(t.passiveDepends[a].mustBeValid)return void(l=!0);if(f&&!o)return s="required",void(l=!1);for(a=0;a<t.activeDepends.length;a++)if(r=n.isFunction(t.activeDepends[a].value),r&&!t.activeDepends[a].value.call(this,n.get(e,t.activeDepends[a].prop))||!r&&!c(t.activeDepends[a]))return void(l=!0);t.global?v():t.required?p(u,t.requiredSteps)&&!o?(s="required",l=!1):v():o?v():l=!0}(),{validationResult:l,error:s,params:o}}function p(e,r,t,a){if(t){var i=n.get(e,t.prop),u=v(e,t,i,a);u.validationResult===!1&&r.push({prop:t.prop,value:i,error:u.error,params:u.params&&u.params.value?u.params.value:u.params})}}function g(r,n,t,a,i){if(a)for(var u=0;u<a.length;u++)h(i,e[a[u]].categories)&&p(r,n,e[a[u]],t);else for(var l in e)h(i,e[l].categories)&&p(r,n,e[l],t)}function h(e,r){if(!e||0===e.length)return!0;if(r&&r.length>0)for(var n in e)if(-1!==r.indexOf(e[n]))return!0;return!1}function m(e,r,n,t){var a=[];return r&&g(r,a,n,void 0,t),e?0===a.length:a}function R(e,r,n,t,a){var i=[];return r&&n&&g(r,i,t,n,a),e?0===i.length:i}function y(e,r,n,a,i){var u=[];if(r&&n)for(var l=0;l<n.length;l++)g(r,u,a,t[n[l]].props,i);return e?0===u.length:u}var r,e={},t={},a={greaterThan:1,gt:1,greaterThanOrEqual:2,gte:2,lowerThan:3,lt:3,lowerThanOrEqual:4,lte:4,equal:5,eq:5,strictlyEqual:6,seq:6,different:7,dif:7,strictlyDifferent:8,sdif:8},i={validate:m,validateProps:R,validateParts:y,addRule:l,ar:l,addRules:s,ars:s,deleteRule:o,dr:o,addValidationRule:f,avr:f,addValidationPart:d,avp:d,operand:a,op:a,validationPartExist:c,debug:u};return function(){r={},r.min=function(e,r){return e>=r.value},r.max=function(e,r){return e<=r.value},r.minLength=function(e,r){return e.length>=r.value},r.maxLength=function(e,r){return e.length<=r.value}}(),i},a=function(){function l(e){return e&&(u=e,t=!1),i}function s(r,n){return d(),e.name=r,e.prop=n,a}function o(r){return r?(e=r,a):i}function f(){return(t||!u)&&(t=!1,u=[]),u.push(e),i}function d(){e={required:!1,global:!1,validationRules:{},activeDepends:[],passiveDepends:[],categories:[]}}function c(){return d(),a}function v(){return d(),t=!0,u=void 0,i}function p(r,t,i){return e.validationRules[r]=n.isObject(t)&&n.isPlainObject(t)?{fn:r,params:t,steps:i}:{fn:r,params:{value:t},steps:i},a}function g(r){return delete e.validationRules[r],a}function h(r){return e.global=r,a}function m(r,n){return e.required=r,e.requiredSteps=n,a}function R(r,n,t){return e.activeDepends.push({prop:r,value:n,operand:t}),a}function y(r,n,t,i){return e.passiveDepends.push({prop:r,value:n,mustBeValid:t,operand:i}),a}function b(r){return r&&e.categories.push(r),a}function D(n){if(n)for(var t in n)e.categories.splice(e.categories,r(n[t]),1);return a}function q(){return u?(u.push(e),t=!0,u):e}var e,u,t=!0,a={required:m,r:m,next:f,end:q,addValidation:p,av:p,deleteValidation:g,dv:g,addActiveDepends:R,aad:R,addPassiveDepends:y,apd:y,global:h,g:h,reset:c,resetWorld:v,addCategories:b,deleteCategories:D},i={newRule:s,modifyRule:o,resetWorld:v,startFrom:l};return i}();e.sovalid=t,e.ruleMaker=a,e.sovalidCommons=n}(window);